<<<<<<< HEAD
=======
else if(is.null(schools_mp) & !is.null(schools_p$ref)){
schools_p <- select(schools_p,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_pol)
}
else if(!is.null(schools_mp) & is.null(schools_p$ref)){
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_mp, schools_pol)
}
else{
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
>>>>>>> 89dd8ab2f9146240c66d2988015f2ce3f6603a31
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_mp, schools_pol)
}
}
else {
schools <-
osmdata_data_frame(schools)
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
return(schools)
}
get_osm_schools("Torroella de Montgrí")
#' @title get_osm_schools
#' @description get all schools registered in openstreetmap from a municipality or comarca in Catalonia in either sf or table format
#' @param place character. name of the place for which to get schools - municipality or comarca
#' @param is_sf logical. If true, returns sf table. If false, a tibble.
#' @returns A sf or tibble with all schools in the desired place.
#' @export
get_osm_schools <- function(place, is_sf = TRUE){
schools <- opq(paste0(place, ", Spain")) |>
add_osm_features(features = c("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
if(is_sf == TRUE) {
schools <- osmdata_sf(schools)
schools_p <- schools$osm_points
schools_pol <- schools$osm_polygons
schools_mp <- schools$osm_multipolygons
if(is.null(schools_p$ref) & is.null(schools_mp)){
schools <- schools_pol
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
else if(is.null(schools_mp) & !is.null(schools_p$ref)){
schools_p <- select(schools_p,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_pol)
}
else if(!is.null(schools_mp) & is.null(schools_p$ref)){
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_mp, schools_pol)
}
else{
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_mp, schools_pol)
}
}
else {
schools <-
osmdata_data_frame(schools)
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
return(schools)
}
get_osm_schools("Torroella de Montgrí")
#' @title get_osm_schools
#' @description get all schools registered in openstreetmap from a municipality or comarca in Catalonia in either sf or table format
#' @param place character. name of the place for which to get schools - municipality or comarca
#' @param is_sf logical. If true, returns sf table. If false, a tibble.
#' @returns A sf or tibble with all schools in the desired place.
#' @export
get_osm_schools <- function(place, is_sf = TRUE){
schools <- opq(paste0(place, ", Spain")) |>
add_osm_features(features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
if(is_sf == TRUE) {
schools <- osmdata_sf(schools)
schools_p <- schools$osm_points
schools_pol <- schools$osm_polygons
schools_mp <- schools$osm_multipolygons
if(is.null(schools_p$ref) & is.null(schools_mp)){
schools <- schools_pol
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
else if(is.null(schools_mp) & !is.null(schools_p$ref)){
schools_p <- select(schools_p,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_pol)
}
<<<<<<< HEAD
escoles$plot
View(escoles$df)
devtools::document()
devtools::document()
library(catosmamenities)
get_all_schools("Palamós")
?get_osm_schools
?get_all_schools
usethis::use_testthat(3)
read.csv("data/categories_equipaments_gencat.csv")
read.csv2("data/categories_equipaments_gencat.csv")
read.csv2("data/categories_equipaments_gencat.csv") -> a
View(a)
read.csv2("data/categories_equipaments_gencat.csv") -> a
write.csv(a, "data/categories_equipaments_gencat.csv")
write.csv(a, "data/categories_equipaments_gencat.csv")
write.csv(a, "raw_data/categories_equipaments_gencat.csv")
=======
else if(!is.null(schools_mp) & is.null(schools_p$ref)){
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_mp, schools_pol)
}
else{
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_mp, schools_pol)
}
}
else {
schools <-
osmdata_data_frame(schools)
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
return(schools)
}
get_osm_schools("Torroella de Montgrí")
get_osm_schools("Torroella de Montgrí")
add_osm_features(opq("Torroella de Montgrí", features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
add_osm_features(opq("Torroella de Montgrí"), features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
#' @title get_osm_schools
#' @description get all schools registered in openstreetmap from a municipality or comarca in Catalonia in either sf or table format
#' @param place character. name of the place for which to get schools - municipality or comarca
#' @param is_sf logical. If true, returns sf table. If false, a tibble.
#' @returns A sf or tibble with all schools in the desired place.
#' @export
get_osm_schools <- function(place, is_sf = TRUE){
schools <- opq(paste0(place, ", Spain")) |>
add_osm_features(opq = _, features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
if(is_sf == TRUE) {
schools <- osmdata_sf(schools)
schools_p <- schools$osm_points
schools_pol <- schools$osm_polygons
schools_mp <- schools$osm_multipolygons
if(is.null(schools_p$ref) & is.null(schools_mp)){
schools <- schools_pol
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
else if(is.null(schools_mp) & !is.null(schools_p$ref)){
schools_p <- select(schools_p,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_pol)
}
else if(!is.null(schools_mp) & is.null(schools_p$ref)){
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_mp, schools_pol)
}
else{
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_mp, schools_pol)
}
}
else {
schools <-
osmdata_data_frame(schools)
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
return(schools)
}
get_osm_schools("Torroella de Montgrí")
#' @title get_osm_schools
#' @description get all schools registered in openstreetmap from a municipality or comarca in Catalonia in either sf or table format
#' @param place character. name of the place for which to get schools - municipality or comarca
#' @param is_sf logical. If true, returns sf table. If false, a tibble.
#' @returns A sf or tibble with all schools in the desired place.
#' @export
get_osm_schools <- function(place, is_sf = TRUE){
schools <- add_osm_features(opq = opq(paste0(place, ", Spain")), features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
if(is_sf == TRUE) {
schools <- osmdata_sf(schools)
schools_p <- schools$osm_points
schools_pol <- schools$osm_polygons
schools_mp <- schools$osm_multipolygons
if(is.null(schools_p$ref) & is.null(schools_mp)){
schools <- schools_pol
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
else if(is.null(schools_mp) & !is.null(schools_p$ref)){
schools_p <- select(schools_p,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_pol)
}
else if(!is.null(schools_mp) & is.null(schools_p$ref)){
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_mp, schools_pol)
}
else{
schools_mp <- select(schools_mp,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools_pol <- select(schools_pol,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
schools <- bind_rows(schools_p, schools_mp, schools_pol)
}
}
else {
schools <-
osmdata_data_frame(schools)
schools <- select(schools,
any_of(c("name", "name:ca", "ref",
"school", "isced:level", "min_age", "max_age",
"operator", "operator:type", "religion",
"amenity", "addr:city", "addr:place", "addr:suburb",
"addr:street", "addr:housenumber", "contact:email",
"contact:fax", "contact:phone", "website",
"wheelchair", "wikidata", "name:etimology:wikidata")))
}
return(schools)
}
get_osm_schools("Torroella de Montgrí")
opq("Torroella de Montgrí") |> add_osm_features(features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school"))
opq("Torroella de Montgrí") |> add_osm_features(features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school")) -> escoles2
escoles2 |> osmdata_data_frame()
escoles2$features
escoles2$osm_types
opq("Torroella de Montgrí") |> add_osm_features(features = list("amenity" = "school",
"amenity" = "kindergarten",
"amenity" = "music_school",
"amenity" = "dancing_school",
"amenity" = "language_school")) |> osmdata_sf()
usethis::edit_r_environ()
gitcreds::gitcreds_set()
gitcreds::gitcreds_set()
>>>>>>> 89dd8ab2f9146240c66d2988015f2ce3f6603a31
